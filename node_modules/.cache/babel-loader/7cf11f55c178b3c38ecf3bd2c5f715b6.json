{"ast":null,"code":"import _asyncToGenerator from\"/Users/jjestrella/DNERO_Protocol/dnerowebwallet/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/jjestrella/DNERO_Protocol/dnerowebwallet/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/jjestrella/DNERO_Protocol/dnerowebwallet/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/jjestrella/DNERO_Protocol/dnerowebwallet/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/jjestrella/DNERO_Protocol/dnerowebwallet/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";function _regeneratorRuntime(){\"use strict\";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */_regeneratorRuntime=function _regeneratorRuntime(){return exports;};var exports={},Op=Object.prototype,hasOwn=Op.hasOwnProperty,$Symbol=\"function\"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||\"@@iterator\",asyncIteratorSymbol=$Symbol.asyncIterator||\"@@asyncIterator\",toStringTagSymbol=$Symbol.toStringTag||\"@@toStringTag\";function define(obj,key,value){return Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}),obj[key];}try{define({},\"\");}catch(err){define=function define(obj,key,value){return obj[key]=value;};}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return generator._invoke=function(innerFn,self,context){var state=\"suspendedStart\";return function(method,arg){if(\"executing\"===state)throw new Error(\"Generator is already running\");if(\"completed\"===state){if(\"throw\"===method)throw arg;return doneResult();}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult;}}if(\"next\"===context.method)context.sent=context._sent=context.arg;else if(\"throw\"===context.method){if(\"suspendedStart\"===state)throw state=\"completed\",context.arg;context.dispatchException(context.arg);}else\"return\"===context.method&&context.abrupt(\"return\",context.arg);state=\"executing\";var record=tryCatch(innerFn,self,context);if(\"normal\"===record.type){if(state=context.done?\"completed\":\"suspendedYield\",record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done};}\"throw\"===record.type&&(state=\"completed\",context.method=\"throw\",context.arg=record.arg);}};}(innerFn,self,context),generator;}function tryCatch(fn,obj,arg){try{return{type:\"normal\",arg:fn.call(obj,arg)};}catch(err){return{type:\"throw\",arg:err};}}exports.wrap=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,function(){return this;});var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){[\"next\",\"throw\",\"return\"].forEach(function(method){define(prototype,method,function(arg){return this._invoke(method,arg);});});}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if(\"throw\"!==record.type){var result=record.arg,value=result.value;return value&&\"object\"==typeof value&&hasOwn.call(value,\"__await\")?PromiseImpl.resolve(value.__await).then(function(value){invoke(\"next\",value,resolve,reject);},function(err){invoke(\"throw\",err,resolve,reject);}):PromiseImpl.resolve(value).then(function(unwrapped){result.value=unwrapped,resolve(result);},function(error){return invoke(\"throw\",error,resolve,reject);});}reject(record.arg);}var previousPromise;this._invoke=function(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl(function(resolve,reject){invoke(method,arg,resolve,reject);});}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg();};}function maybeInvokeDelegate(delegate,context){var method=delegate.iterator[context.method];if(undefined===method){if(context.delegate=null,\"throw\"===context.method){if(delegate.iterator.return&&(context.method=\"return\",context.arg=undefined,maybeInvokeDelegate(delegate,context),\"throw\"===context.method))return ContinueSentinel;context.method=\"throw\",context.arg=new TypeError(\"The iterator does not provide a 'throw' method\");}return ContinueSentinel;}var record=tryCatch(method,delegate.iterator,context.arg);if(\"throw\"===record.type)return context.method=\"throw\",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,\"return\"!==context.method&&(context.method=\"next\",context.arg=undefined),context.delegate=null,ContinueSentinel):info:(context.method=\"throw\",context.arg=new TypeError(\"iterator result is not an object\"),context.delegate=null,ContinueSentinel);}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry);}function resetTryEntry(entry){var record=entry.completion||{};record.type=\"normal\",delete record.arg,entry.completion=record;}function Context(tryLocsList){this.tryEntries=[{tryLoc:\"root\"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0);}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if(\"function\"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;){if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;}return next.value=undefined,next.done=!0,next;};return next.next=next;}}return{next:doneResult};}function doneResult(){return{value:undefined,done:!0};}return GeneratorFunction.prototype=GeneratorFunctionPrototype,define(Gp,\"constructor\",GeneratorFunctionPrototype),define(GeneratorFunctionPrototype,\"constructor\",GeneratorFunction),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,\"GeneratorFunction\"),exports.isGeneratorFunction=function(genFun){var ctor=\"function\"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||\"GeneratorFunction\"===(ctor.displayName||ctor.name));},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,\"GeneratorFunction\")),genFun.prototype=Object.create(Gp),genFun;},exports.awrap=function(arg){return{__await:arg};},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,function(){return this;}),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then(function(result){return result.done?result.value:iter.next();});},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,\"Generator\"),define(Gp,iteratorSymbol,function(){return this;}),define(Gp,\"toString\",function(){return\"[object Generator]\";}),exports.keys=function(object){var keys=[];for(var key in object){keys.push(key);}return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next;}return next.done=!0,next;};},exports.values=values,Context.prototype={constructor:Context,reset:function reset(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=undefined,this.done=!1,this.delegate=null,this.method=\"next\",this.arg=undefined,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this){\"t\"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=undefined);}},stop:function stop(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if(\"throw\"===rootRecord.type)throw rootRecord.arg;return this.rval;},dispatchException:function dispatchException(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type=\"throw\",record.arg=exception,context.next=loc,caught&&(context.method=\"next\",context.arg=undefined),!!caught;}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if(\"root\"===entry.tryLoc)return handle(\"end\");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,\"catchLoc\"),hasFinally=hasOwn.call(entry,\"finallyLoc\");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc);}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);}else{if(!hasFinally)throw new Error(\"try statement without catch or finally\");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc);}}}},abrupt:function abrupt(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,\"finallyLoc\")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break;}}finallyEntry&&(\"break\"===type||\"continue\"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method=\"next\",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record);},complete:function complete(record,afterLoc){if(\"throw\"===record.type)throw record.arg;return\"break\"===record.type||\"continue\"===record.type?this.next=record.arg:\"return\"===record.type?(this.rval=this.arg=record.arg,this.method=\"return\",this.next=\"end\"):\"normal\"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel;},finish:function finish(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel;}},catch:function _catch(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if(\"throw\"===record.type){var thrown=record.arg;resetTryEntry(entry);}return thrown;}}throw new Error(\"illegal catch attempt\");},delegateYield:function delegateYield(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName:resultName,nextLoc:nextLoc},\"next\"===this.method&&(this.arg=undefined),ContinueSentinel;}},exports;}import TransportU2F from\"@ledgerhq/hw-transport-u2f\";import TransportWebUSB from\"@ledgerhq/hw-transport-webusb\";import Eth from\"@ledgerhq/hw-app-eth\";import _ from\"lodash\";import Ledger from\"../../services/Ledger\";var _require=require('events'),EventEmitter=_require.EventEmitter;var HDKey=require('hdkey');var ethUtil=require('ethereumjs-util');var hdPathString=\"m/44'/60'/0'\";var type='Ledger Hardware';var pathBase='m';var MAX_INDEX=1000;var LedgerKeyring=/*#__PURE__*/function(_EventEmitter){_inherits(LedgerKeyring,_EventEmitter);var _super=_createSuper(LedgerKeyring);function LedgerKeyring(){var _this;var opts=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,LedgerKeyring);_this=_super.call(this);_this.accountIndexes={};_this.type=type;_this.page=0;_this.perPage=5;_this.unlockedAccount=0;_this.hdk=new HDKey();_this.paths={};_this.deserialize(opts);return _this;}_createClass(LedgerKeyring,[{key:\"serialize\",value:function serialize(){return Promise.resolve({hdPath:this.hdPath,accounts:this.accounts,accountIndexes:this.accountIndexes});}},{key:\"deserialize\",value:function deserialize(){var _this2=this;var opts=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.hdPath=opts.hdPath||hdPathString;this.accounts=opts.accounts||[];this.accountIndexes=opts.accountIndexes||{};if(this._isBIP44()){// Remove accounts that don't have corresponding account indexes\nthis.accounts=this.accounts.filter(function(account){return Object.keys(_this2.accountIndexes).includes(ethUtil.toChecksumAddress(account));});}return Promise.resolve();}},{key:\"isUnlocked\",value:function isUnlocked(){return!!(this.hdk&&this.hdk.publicKey);}},{key:\"setAccountToUnlock\",value:function setAccountToUnlock(index){this.unlockedAccount=parseInt(index,10);}},{key:\"setHdPath\",value:function setHdPath(hdPath){// Reset HDKey if the path changes\nif(this.hdPath!==hdPath){this.hdk=new HDKey();}this.hdPath=hdPath;}},{key:\"unlock\",value:function unlock(hdPath){var _this3=this;if(this.isUnlocked()&&!hdPath)return Promise.resolve('already unlocked');var path=hdPath?this._toLedgerPath(hdPath):this.hdPath;return new Promise(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(resolve,reject){var app,payload;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return _this3._getETH();case 3:app=_context.sent;_context.next=6;return app.getAddress(path,false,true);case 6:payload=_context.sent;_this3.hdk.publicKey=new Buffer(payload.publicKey,'hex');_this3.hdk.chainCode=new Buffer(payload.chainCode,'hex');resolve(payload.address.toLowerCase());_context.next=15;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](0);reject(new Error(_context.t0.message||'Unknown error'));case 15:case\"end\":return _context.stop();}}},_callee,null,[[0,12]]);}));return function(_x,_x2){return _ref.apply(this,arguments);};}());}},{key:\"addAccounts\",value:function addAccounts(){var _this4=this;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;return new Promise(function(resolve,reject){_this4.unlock().then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(_){var from,to,i,address,path;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:from=_this4.unlockedAccount;to=from+n;_this4.accounts=[];i=from;case 4:if(!(i<to)){_context2.next=20;break;}address=void 0;if(!_this4._isBIP44()){_context2.next=14;break;}path=_this4._getPathForIndex(i);_context2.next=10;return _this4.unlock(path);case 10:address=_context2.sent;_this4.accountIndexes[ethUtil.toChecksumAddress(address)]=i;_context2.next=15;break;case 14:address=_this4._addressFromIndex(pathBase,i);case 15:_this4.accounts.push(address);_this4.page=0;case 17:i++;_context2.next=4;break;case 20:resolve(_this4.accounts);case 21:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x3){return _ref2.apply(this,arguments);};}()).catch(function(e){reject(e);});});}},{key:\"getFirstPage\",value:function getFirstPage(){this.page=0;return this._getPage(1);}},{key:\"getNextPage\",value:function getNextPage(){return this._getPage(1);}},{key:\"getPreviousPage\",value:function getPreviousPage(){return this._getPage(-1);}},{key:\"getAccounts\",value:function getAccounts(){return Promise.resolve(this.accounts.slice());}},{key:\"removeAccount\",value:function removeAccount(address){if(!this.accounts.map(function(a){return a.toLowerCase();}).includes(address.toLowerCase())){throw new Error(\"Address \".concat(address,\" not found in this keyring\"));}this.accounts=this.accounts.filter(function(a){return a.toLowerCase()!==address.toLowerCase();});delete this.accountIndexes[ethUtil.toChecksumAddress(address)];}},{key:\"signAndSendTransaction\",value:function(){var _signAndSendTransaction=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(fromAddress,transaction,provider){var unlockResult,hdPath,checksummedAddress,sequence,app,signedTxRaw,result;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return this.unlock();case 2:unlockResult=_context3.sent;if(!this._isBIP44()){_context3.next=10;break;}checksummedAddress=ethUtil.toChecksumAddress(fromAddress);if(Object.keys(this.accountIndexes).includes(checksummedAddress)){_context3.next=7;break;}throw new Error(\"Ledger: Index for address '\".concat(checksummedAddress,\"' not found\"));case 7:hdPath=this._getPathForIndex(this.accountIndexes[checksummedAddress]);_context3.next=11;break;case 10:hdPath=this._toLedgerPath(this._pathFromAddress(fromAddress));case 11:if(!_.isNil(transaction.getSequenceOverride())){_context3.next=17;break;}_context3.next=14;return provider.getTransactionCount(fromAddress);case 14:sequence=_context3.sent;sequence=sequence+1;transaction.setSequence(sequence);case 17:transaction.setFrom(ethUtil.toChecksumAddress(fromAddress));_context3.next=20;return this._getETH();case 20:app=_context3.sent;_context3.next=23;return Ledger.signTransaction(app,hdPath,transaction);case 23:signedTxRaw=_context3.sent;result=provider.sendTransaction(signedTxRaw);return _context3.abrupt(\"return\",Promise.resolve(result));case 26:case\"end\":return _context3.stop();}}},_callee3,this);}));function signAndSendTransaction(_x4,_x5,_x6){return _signAndSendTransaction.apply(this,arguments);}return signAndSendTransaction;}()},{key:\"signMessage\",value:function signMessage(withAccount,data){throw new Error('Not supported on this device');}// For personal_sign, we need to prefix the message:\n},{key:\"signPersonalMessage\",value:function signPersonalMessage(withAccount,message){throw new Error('Not supported on this device');}},{key:\"signTypedData\",value:function signTypedData(withAccount,typedData){throw new Error('Not supported on this device');}},{key:\"exportAccount\",value:function exportAccount(address){throw new Error('Not supported on this device');}},{key:\"forgetDevice\",value:function forgetDevice(){this.accounts=[];this.page=0;this.unlockedAccount=0;this.paths={};this.hdk=new HDKey();}/* PRIVATE METHODS */},{key:\"_getPage\",value:function(){var _getPage2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(increment){var from,to,accounts;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:this.page+=increment;if(this.page<=0){this.page=1;}from=(this.page-1)*this.perPage;to=from+this.perPage;_context4.next=6;return this.unlock();case 6:if(!this._isBIP44()){_context4.next=12;break;}_context4.next=9;return this._getAccountsBIP44(from,to);case 9:accounts=_context4.sent;_context4.next=13;break;case 12:accounts=this._getAccountsLegacy(from,to);case 13:return _context4.abrupt(\"return\",accounts);case 14:case\"end\":return _context4.stop();}}},_callee4,this);}));function _getPage(_x7){return _getPage2.apply(this,arguments);}return _getPage;}()},{key:\"_getAccountsBIP44\",value:function(){var _getAccountsBIP=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(from,to){var accounts,i,path,address;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:accounts=[];i=from;case 2:if(!(i<to)){_context5.next=11;break;}path=this._getPathForIndex(i);_context5.next=6;return this.unlock(path);case 6:address=_context5.sent;accounts.push({address:address.toLowerCase(),balance:null,index:i});case 8:i++;_context5.next=2;break;case 11:return _context5.abrupt(\"return\",accounts);case 12:case\"end\":return _context5.stop();}}},_callee5,this);}));function _getAccountsBIP44(_x8,_x9){return _getAccountsBIP.apply(this,arguments);}return _getAccountsBIP44;}()},{key:\"_getAccountsLegacy\",value:function _getAccountsLegacy(from,to){var accounts=[];for(var i=from;i<to;i++){var address=this._addressFromIndex(pathBase,i);accounts.push({address:address,balance:null,index:i});this.paths[ethUtil.toChecksumAddress(address)]=i;}return accounts;}},{key:\"_padLeftEven\",value:function _padLeftEven(hex){return hex.length%2!==0?\"0\".concat(hex):hex;}},{key:\"_normalize\",value:function _normalize(buf){return this._padLeftEven(ethUtil.bufferToHex(buf).toLowerCase());}},{key:\"_addressFromIndex\",value:function _addressFromIndex(pathBase,i){var dkey=this.hdk.derive(\"\".concat(pathBase,\"/\").concat(i));var address=ethUtil.publicToAddress(dkey.publicKey,true).toString('hex');return ethUtil.toChecksumAddress(address).toLowerCase();}},{key:\"_pathFromAddress\",value:function _pathFromAddress(address){var checksummedAddress=ethUtil.toChecksumAddress(address);var index=this.paths[checksummedAddress];if(typeof index==='undefined'){for(var i=0;i<MAX_INDEX;i++){if(checksummedAddress===this._addressFromIndex(pathBase,i)){index=i;break;}}}if(typeof index==='undefined'){throw new Error('Unknown address');}return this._getPathForIndex(index);}},{key:\"_getPathForIndex\",value:function _getPathForIndex(index){// Check if the path is BIP 44 (Ledger Live)\nreturn this._isBIP44()?\"m/44'/60'/\".concat(index,\"'/0/0\"):\"\".concat(this.hdPath).concat(index);}},{key:\"_isBIP44\",value:function _isBIP44(){return this.hdPath===\"m/44'/60'/0'/0/0\";}},{key:\"_toLedgerPath\",value:function _toLedgerPath(path){return path.toString().replace('m/','');}},{key:\"_getETH\",value:function(){var _getETH2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(){var transport,app;return _regeneratorRuntime().wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:if(!(navigator.userAgent.toLowerCase().indexOf('firefox')>-1)){_context6.next=6;break;}_context6.next=3;return TransportU2F.create();case 3:transport=_context6.sent;_context6.next=9;break;case 6:_context6.next=8;return TransportWebUSB.create();case 8:transport=_context6.sent;case 9:app=new Eth(transport);return _context6.abrupt(\"return\",app);case 11:case\"end\":return _context6.stop();}}},_callee6);}));function _getETH(){return _getETH2.apply(this,arguments);}return _getETH;}()}]);return LedgerKeyring;}(EventEmitter);LedgerKeyring.type=type;export default LedgerKeyring;","map":{"version":3,"names":["TransportU2F","TransportWebUSB","Eth","_","Ledger","require","EventEmitter","HDKey","ethUtil","hdPathString","type","pathBase","MAX_INDEX","LedgerKeyring","opts","accountIndexes","page","perPage","unlockedAccount","hdk","paths","deserialize","Promise","resolve","hdPath","accounts","_isBIP44","filter","account","Object","keys","includes","toChecksumAddress","publicKey","index","parseInt","isUnlocked","path","_toLedgerPath","reject","_getETH","app","getAddress","payload","Buffer","chainCode","address","toLowerCase","Error","message","n","unlock","then","from","to","i","_getPathForIndex","_addressFromIndex","push","catch","e","_getPage","slice","map","a","fromAddress","transaction","provider","unlockResult","checksummedAddress","_pathFromAddress","isNil","getSequenceOverride","getTransactionCount","sequence","setSequence","setFrom","signTransaction","signedTxRaw","result","sendTransaction","withAccount","data","typedData","increment","_getAccountsBIP44","_getAccountsLegacy","balance","hex","length","buf","_padLeftEven","bufferToHex","dkey","derive","publicToAddress","toString","replace","navigator","userAgent","indexOf","create","transport"],"sources":["/Users/jjestrella/DNERO_Protocol/dnerowebwallet/src/keyrings/ledger/index.js"],"sourcesContent":["import TransportU2F from \"@ledgerhq/hw-transport-u2f\";\nimport TransportWebUSB from \"@ledgerhq/hw-transport-webusb\";\nimport Eth from \"@ledgerhq/hw-app-eth\";\nimport _ from \"lodash\";\nimport Ledger from \"../../services/Ledger\";\n\nconst {EventEmitter} = require('events')\nconst HDKey = require('hdkey')\nconst ethUtil = require('ethereumjs-util')\n\nconst hdPathString = `m/44'/60'/0'`\nconst type = 'Ledger Hardware'\nconst pathBase = 'm'\nconst MAX_INDEX = 1000\n\nclass LedgerKeyring extends EventEmitter {\n    constructor (opts = {}) {\n        super()\n        this.accountIndexes = {}\n        this.type = type\n        this.page = 0\n        this.perPage = 5\n        this.unlockedAccount = 0\n        this.hdk = new HDKey()\n        this.paths = {}\n        this.deserialize(opts)\n    }\n\n    serialize () {\n        return Promise.resolve({\n            hdPath: this.hdPath,\n            accounts: this.accounts,\n            accountIndexes: this.accountIndexes,\n        })\n    }\n\n    deserialize (opts = {}) {\n        this.hdPath = opts.hdPath || hdPathString\n        this.accounts = opts.accounts || []\n        this.accountIndexes = opts.accountIndexes || {}\n\n        if (this._isBIP44()) {\n            // Remove accounts that don't have corresponding account indexes\n            this.accounts = this.accounts\n                .filter(account => Object.keys(this.accountIndexes).includes(ethUtil.toChecksumAddress(account)))\n        }\n\n        return Promise.resolve()\n    }\n\n    isUnlocked () {\n        return !!(this.hdk && this.hdk.publicKey)\n    }\n\n    setAccountToUnlock (index) {\n        this.unlockedAccount = parseInt(index, 10)\n    }\n\n    setHdPath (hdPath) {\n        // Reset HDKey if the path changes\n        if (this.hdPath !== hdPath) {\n            this.hdk = new HDKey()\n        }\n        this.hdPath = hdPath\n    }\n\n    unlock (hdPath) {\n        if (this.isUnlocked() && !hdPath) return Promise.resolve('already unlocked')\n        const path = hdPath ? this._toLedgerPath(hdPath) : this.hdPath\n        return new Promise(async (resolve, reject) => {\n            try {\n                const app = await this._getETH();\n                const payload = await app.getAddress(path, false, true);\n                this.hdk.publicKey = new Buffer(payload.publicKey, 'hex');\n                this.hdk.chainCode = new Buffer(payload.chainCode, 'hex');\n\n                resolve(payload.address.toLowerCase());\n            }\n            catch (e) {\n                reject(new Error(e.message || 'Unknown error'))\n            }\n        })\n    }\n\n    addAccounts (n = 1) {\n        return new Promise((resolve, reject) => {\n            this.unlock()\n                .then(async _ => {\n                    const from = this.unlockedAccount\n                    const to = from + n\n                    this.accounts = []\n                    for (let i = from; i < to; i++) {\n                        let address\n                        if (this._isBIP44()) {\n                            const path = this._getPathForIndex(i)\n                            address = await this.unlock(path)\n                            this.accountIndexes[ethUtil.toChecksumAddress(address)] = i\n                        } else {\n                            address = this._addressFromIndex(pathBase, i)\n                        }\n                        this.accounts.push(address)\n                        this.page = 0\n                    }\n                    resolve(this.accounts)\n                })\n                .catch(e => {\n                    reject(e)\n                })\n        })\n    }\n\n    getFirstPage () {\n        this.page = 0\n        return this._getPage(1)\n    }\n\n    getNextPage () {\n        return this._getPage(1)\n    }\n\n    getPreviousPage () {\n        return this._getPage(-1)\n    }\n\n    getAccounts () {\n        return Promise.resolve(this.accounts.slice())\n    }\n\n    removeAccount (address) {\n        if (!this.accounts.map(a => a.toLowerCase()).includes(address.toLowerCase())) {\n            throw new Error(`Address ${address} not found in this keyring`)\n        }\n        this.accounts = this.accounts.filter(a => a.toLowerCase() !== address.toLowerCase())\n        delete this.accountIndexes[ethUtil.toChecksumAddress(address)]\n    }\n\n    async signAndSendTransaction (fromAddress, transaction, provider) {\n        const unlockResult = await this.unlock();\n        let hdPath;\n        if (this._isBIP44()) {\n            const checksummedAddress = ethUtil.toChecksumAddress(fromAddress)\n            if (!Object.keys(this.accountIndexes).includes(checksummedAddress)) {\n                throw (new Error(`Ledger: Index for address '${checksummedAddress}' not found`))\n            }\n            hdPath = this._getPathForIndex(this.accountIndexes[checksummedAddress])\n        } else {\n            hdPath = this._toLedgerPath(this._pathFromAddress(fromAddress))\n        }\n\n        if(_.isNil(transaction.getSequenceOverride())){\n            let sequence = await provider.getTransactionCount(fromAddress);\n            sequence = sequence + 1;\n            transaction.setSequence(sequence);\n        }\n        transaction.setFrom(ethUtil.toChecksumAddress(fromAddress));\n\n        const app = await this._getETH();\n        const signedTxRaw = await Ledger.signTransaction(app, hdPath, transaction);\n        const result = provider.sendTransaction(signedTxRaw);\n\n        return Promise.resolve(result);\n    }\n\n    signMessage (withAccount, data) {\n        throw new Error('Not supported on this device')\n    }\n\n    // For personal_sign, we need to prefix the message:\n    signPersonalMessage (withAccount, message) {\n        throw new Error('Not supported on this device')\n    }\n\n    signTypedData (withAccount, typedData) {\n        throw new Error('Not supported on this device')\n    }\n\n    exportAccount (address) {\n        throw new Error('Not supported on this device')\n    }\n\n    forgetDevice () {\n        this.accounts = []\n        this.page = 0\n        this.unlockedAccount = 0\n        this.paths = {}\n        this.hdk = new HDKey()\n    }\n\n    /* PRIVATE METHODS */\n\n    async _getPage (increment) {\n        this.page += increment\n\n        if (this.page <= 0) { this.page = 1 }\n        const from = (this.page - 1) * this.perPage\n        const to = from + this.perPage\n\n        await this.unlock()\n        let accounts\n        if (this._isBIP44()) {\n            accounts = await this._getAccountsBIP44(from, to)\n        } else {\n            accounts = this._getAccountsLegacy(from, to)\n        }\n        return accounts\n    }\n\n    async _getAccountsBIP44 (from, to) {\n        const accounts = []\n\n        for (let i = from; i < to; i++) {\n            const path = this._getPathForIndex(i)\n            const address = await this.unlock(path)\n            accounts.push({\n                address: address.toLowerCase(),\n                balance: null,\n                index: i,\n            })\n        }\n        return accounts\n    }\n\n    _getAccountsLegacy (from, to) {\n        const accounts = []\n\n        for (let i = from; i < to; i++) {\n            const address = this._addressFromIndex(pathBase, i)\n            accounts.push({\n                address: address,\n                balance: null,\n                index: i,\n            })\n            this.paths[ethUtil.toChecksumAddress(address)] = i\n        }\n        return accounts\n    }\n\n    _padLeftEven (hex) {\n        return hex.length % 2 !== 0 ? `0${hex}` : hex\n    }\n\n    _normalize (buf) {\n        return this._padLeftEven(ethUtil.bufferToHex(buf).toLowerCase())\n    }\n\n    _addressFromIndex (pathBase, i) {\n        const dkey = this.hdk.derive(`${pathBase}/${i}`)\n        const address = ethUtil\n            .publicToAddress(dkey.publicKey, true)\n            .toString('hex')\n        return ethUtil.toChecksumAddress(address).toLowerCase()\n    }\n\n    _pathFromAddress (address) {\n        const checksummedAddress = ethUtil.toChecksumAddress(address)\n        let index = this.paths[checksummedAddress]\n        if (typeof index === 'undefined') {\n            for (let i = 0; i < MAX_INDEX; i++) {\n                if (checksummedAddress === this._addressFromIndex(pathBase, i)) {\n                    index = i\n                    break\n                }\n            }\n        }\n\n        if (typeof index === 'undefined') {\n            throw new Error('Unknown address')\n        }\n        return this._getPathForIndex(index)\n    }\n\n    _getPathForIndex (index) {\n        // Check if the path is BIP 44 (Ledger Live)\n        return this._isBIP44() ? `m/44'/60'/${index}'/0/0` : `${this.hdPath}${index}`\n    }\n\n    _isBIP44 () {\n        return this.hdPath === `m/44'/60'/0'/0/0`\n    }\n\n    _toLedgerPath (path) {\n        return path.toString().replace('m/', '')\n    }\n\n    async _getETH () {\n        let transport;\n        if(navigator.userAgent.toLowerCase().indexOf('firefox') > -1){\n            transport = await TransportU2F.create();\n        }\n        else {\n            transport = await TransportWebUSB.create();\n        }\n        const app = new Eth(transport);\n\n        return app;\n    }\n}\n\nLedgerKeyring.type = type;\n\nexport default LedgerKeyring;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}